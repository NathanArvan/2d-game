<!-- This will be the top level view a player see when they are in a battle -->
 <div class="battle-map-ui-container">

    <div class="turn-info-container">
      <div>Round: {{ battle()?.roundNumber }}</div>
      <div>Turn: {{ battle()?.currentTurn  }}</div>
      <div>Characters Turn: {{ currentCharacter()?.name }}</div>
      <div>Actions Remaining: {{ remainingActionsInTurn() }}</div>
    </div>

    <div class="map-container">
      <app-map [characters]="characters()" [items]="items()" [location]="location()" (battleCellClicked)="onBattleCellClicked($event)"></app-map>
    </div>

    <div class="character-info-container">
      <div>Characters</div>
      <div class="characterList">
        @for (character of characters(); track $index) {
          <div>
            <span>Name: {{ character.name }} Health: {{character.currentHealth}} / {{character.health}}</span>
          </div>
        }
      </div>
    </div>
 </div>

<div class="action-bar-container">
  @if (remainingActionsInTurn() > 0) {
    <div class="action-bar">
      @switch (actionState()) {
        @case (actionStates.NoSelection) {
          @for (action of characterActions(); track $index) {
            <button (click)="selectAction(action)">{{ action.name }}</button>
          }
        }
        @case (actionStates.MoveSelected) {
          <span>Select a square to move to</span>
          <button (click)="cancelAction()">Cancel</button>
        }
        @case (actionStates.AttackSelected) {
          <span>Select an enemy to attack</span>
          <button (click)="cancelAction()">Cancel</button>
        }
        @case (actionStates.ItemPickUpSelected) {
          <span>Select an item to pick up</span>
          <button (click)="cancelAction()">Cancel</button>
        }
      }
    </div>
  }
  <button (click)="endTurn()">End Turn</button>
</div>